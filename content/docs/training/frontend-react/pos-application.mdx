---
title: POS Application
---

## Scope

[Explore Square POS APIs](https://squareup.com/us/en)

### Authentication

* Implement OAuth-based login using Square's authentication system.
* Utilize NextAuth.js for handling authentication:
* Configure NextAuth to work with Square's OAuth provider.
* Set up NextAuth API routes and handle callbacks.
* Implement session management using NextAuth's built-in functionality.
* Ensure proper SSR authentication:
* Use NextAuth for server-side authentication checks.
* Implement client-side authentication state management using NextAuth's useSession hook.
* Set up protected routes and API endpoints using NextAuth middleware.
* Implement secure logout functionality.

### Product Listing

* The homepage should display a list of products using Server-Side Rendering (SSR).
* User should be able to search and apply filters to the products.
* Each product card should show:
  * Name
  * Price
  * Image
  * Product Variants
  * "Add to Cart" button
* Allow users to increase or decrease product quantity directly on the card.
* After clicking "Add to Cart," replace the button with quantity controls (+/- buttons).

### Checkout Management


1. Users should be able to add products to their cart.
2. The cart should be accessible from a side drawer, showing a list of added items.
3. Quantity can be changed from the cart for any individual product
4. Discounts

   
   1. Users should have the option to apply discounts to individual items or the entire order.
   2. If a discount currently applied at the order level is removed from an individual item, then the respective discount no longer remains an order level discount and should be applied on the remaining items individually.
   3. Discounts should be retrieved from an API and displayed as options during the checkout process.
   4. The application should recalculate the order amount dynamically when discounts are applied.
5. Taxes

   
   1. Users should be able to toggle taxes on/off for individual items or the entire order to see the amounts with and without taxes.
   2. If a tax currently applied at the order level is removed from an individual item, then the respective tax no longer remains an order level tax and should be applied on the remaining items individually.
   3. Tax options should be retrieved from an API and displayed during the checkout process.
   4. The application should recalculate the order amount dynamically when tax settings are changed.

### Payment Processing

* Display a summary of selected items, applied discounts, and taxes in the checkout.
* Implement order calculation using Next.js server actions.
* Provide a button to confirm and place the order.
* Handle order confirmation and display appropriate success messages.

## Implementation Guidelines

### Square POS Integration

* Use Next.js server actions to integrate directly with Square POS APIs.
* Implement functions for product retrieval, discount and tax options, and order processing.
* Ensure Square API calls are made securely using authenticated sessions.
* Use services to separate API logic from components, and apply the Dependency Inversion Principle (DIP) to depend on abstractions for improved flexibility.

### User Interface

* Ensure the UI is responsive and provides a seamless experience across devices.
* Use appropriate loading indicators (e.g., spinners, skeletons) during data fetching.
* Implement a consistent UI for login/logout functionality.

### Server-Side Rendering (SSR)

* Implement SSR for the homepage product listing.
* Use streaming UI concepts for products added to the cart to improve initial load times.
* Utilize NextAuth for authentication checks in SSR pages.

### Error Handling

* Implement error boundaries for the SSR page to gracefully handle rendering errors.
* Provide meaningful error messages and fallback UI for various error scenarios.
* Handle authentication errors gracefully, redirecting to login when necessary.

### Code Structure

* Organize code modularly, following Next.js best practices.
* Centralize NextAuth configuration and custom hooks for authentication.

### Security

* Leverage NextAuth's built-in security features for token handling and session management.
* Implement additional security measures to protect against common web vulnerabilities.
* Ensure secure handling of Square API credentials and tokens.

## Implementation

### Phase 1: Setup and Authentication

Tasks:

1. Use pnpm as package manager
2. Set up the Next.js project with TypeScript.
3. Configure [Panda CSS](https://panda-css.com/) and [Pallas UI](https://pallas-ui-docs.vercel.app/).
4. Set up linting and build scripts.
5. Implement [NextAuth.js](https://next-auth.js.org/) for authentication:
6. Configure Square OAuth provider.
7. Set up NextAuth API routes and callbacks.
8. Implement protected routes using NextAuth middleware.
9. Create login/logout UI components.

Expectations:

* Project structure follows Next.js best practices for TypeScript projects.
* Pallas UI components are properly configured and themed using options provided by Pallas UI (and custom Panda CSS tokens, if necessary).
* ESLint and Prettier are set up with appropriate rules.
* NextAuth is fully integrated with Square OAuth:
* Users can log in and out seamlessly.
* Protected routes are properly secured.
* Server-side and client-side authentication checks are implemented.
* Login/logout UI is intuitive and responsive.

### Phase 2: Product Listing and Cart

Tasks:


1. Create an intuitive UI to list down all the products coming from square.
2. Implement product search and filtering functionality.
3. Develop the shopping cart as a side drawer.
4. Use [Tanstack react query](https://tanstack.com/query/latest/docs/react/overview) for data fetching and caching.

Expectations:

* Homepage renders server-side for optimal performance.
* Create a custom product card component using Pallas UI tokens.
* Product search and filtering are fast and accurate.
* Use streaming UI patterns to progressively display content and components to enhance perceived performance.
* React Query is properly implemented for efficient data management.
* All operations are secure and respect the user's authentication status.
* Implement well-defined component [patterns](https://outline.carbonteq.com/s/a124241a-28a7-479b-8268-405f36743850) (container/layout/UI) and use composition to build a modular and maintainable [codebase](https://github.com/Yacouri/reactjs-folders-boilerplate/tree/master/src).
* No global state management library is used; rely on React's built-in state management and context API if necessary.


<Aside type="info">
Explore different design aesthetics such as minimalism, neo-brutalism, and glassmorphism. Find inspirations on design platforms like [Dribbble](https://dribbble.com/) or [Behance](https://www.behance.net/).

Refactor the codebase to separate side-effects and API calls from components.
</Aside>

### Phase 3: Checkout Process

Tasks:


1. Implement the checkout process with discounts and taxes.
2. Create custom hooks for business logic (e.g., applying discounts/taxes).

Expectations:

* Checkout process is smooth and intuitive.
* Discounts and taxes are correctly applied and calculated.
* Custom hooks encapsulate complex business logic, making it reusable and testable.
* [Follow immutability practices consistently throughout the application to ensure data integrity and predictable behavior.](https://react.dev/learn/adding-interactivity)
* State management relies on React's built-in features (useState, useReducer) rather than external libraries.

### Phase 4: Optimization and Testing

Tasks:


1. Utilize a third-party library, such as [Zustand](https://docs.pmnd.rs/zustand/getting-started/introduction), to move local state management logic to a global state.
2. Implement error boundaries for the SSR page.
3. Configure [React Scan](https://react-scan.com/) and use it to find areas to optimize rendering.
4. Optimize performance using Next.js image optimization, font optimization and other techniques.
5. Configure [React Compiler](https://react.dev/learn/react-compiler) in your project. Build the application with React Compiler enabled.
6. Use React Scan to compare the performance of your unoptimized and optimized implementations, both with React Compiler enabled and disabled.
7. Write unit tests for key components, including NextAuth integration.
8. Develop end-to-end tests for critical user journeys, including login/logout flows.
9. Perform security audit, focusing on authentication and API integrations.

Expectations:

* Error boundaries gracefully handle and log SSR errors.
* Images are optimized for different devices and network conditions.
* Key components have comprehensive unit tests with good coverage.
* End-to-end tests cover all critical user flows, ensuring a robust user experience.
* Security audit reveals no critical vulnerabilities; any found issues are addressed promptly.
* Performance metrics (Core Web Vitals) meet or exceed industry standards.

 


<Aside type="tip">
Explore [middleware](https://nextjs.org/docs/pages/building-your-application/deploying#middleware) in Next
</Aside>


<Aside type="info">
Explore [ImmerJs](https://immerjs.github.io/immer/), [NextJs image optimization](https://nextjs.org/docs/pages/building-your-application/deploying#image-optimization)

Develop understanding of web vitals
</Aside>

## Additional Considerations

* Explore advanced NextAuth features like callbacks and events for custom behavior.
* Implement proper error logging and monitoring (e.g., Sentry integration).
* Ensure adherence to Web Vitals for optimal performance.
* Regularly review and update NextAuth configuration to adhere to best practices.

 

## Extraâ€™s

* Signals
